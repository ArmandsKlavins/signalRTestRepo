<div>
    <h1>Messages</h1>
    <input hidden type="text" id="message" />
    <input hidden type="button" id="sendmessage" value="Send" />
    <input type="text" id="name" />
    <input type="button" id="setName" value="Set" />
    <div style="width:400px; padding:10px; margin-top:10px; background-color:lightgrey;" id="messages">
        @*<div class="recieve-container"><span class="recieve"><span style="font-size:12px;font-weight:600;">Name<br /></span>text</span></div>
        <div class="send-container"><span class="send">text</span></div>
        <div class="recieve-container"><span class="recieve">text adasd sada sdads as</span></div>
        <div class="send-container"><span class="send">text ads asdasd asd asd  </span></div>*@

    </div>
</div>
@section scripts {
    <script src="~/Scripts/jquery.signalR-2.3.0.min.js"></script>
    <!--Reference the autogenerated SignalR hub script. -->
    <script src="~/signalr/hubs"></script>
    <!--SignalR script to update the chat page and send messages.-->
    <script>
        var value = '@ViewBag.Check';
        var value2 = true;
        if ('@ViewBag.Check' == 'Truse') {
            console.log("True");
        }
        $(function () {
            var name = null;
            // Reference the auto-generated proxy for the hub.
            var chat = $.connection.chatHub;
            // Create a function that the hub can call back to display messages.
            chat.client.addNewMessageToPage = function (message, senederName) {
                var template = null;
                if (senederName == name) {
                    template = '<div class="send-container"><span class="send"><span style="font-size:12px;font-weight:600;">{{name}}<br /></span>{{message}}</span></div>'
                } else {
                    template = '<div class="recieve-container"><span class="recieve"><span style="font-size:12px;font-weight:600;">{{name}}<br /></span>{{message}}</span></div>'
                }

                template = template.replace("{{message}}", message);
                template = template.replace("{{name}}", senederName);
                $('#messages').append(template);
            };
            // Start the connection.
            $.connection.hub.start().done(function () {
                chat.server.join();
                $('#sendmessage').click(function () {
                    chat.server.sendMsg($('#message').val(), name);
                    $('#message').val('');
                });
            });

            $('#setName').click(function () {
                if ($('#name').val() != '') {
                    name = $('#name').val();
                    $('#setName').hide();
                    $('#name').hide();
                    $('#message').show();
                    $('#sendmessage').show();
                }
            });

        });
    </script>
}
